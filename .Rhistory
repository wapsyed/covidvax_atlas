labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type
median
median_i = table %>%
select(genes, sample, counts, disease_vac) %>%
filter(disease_vac == "H") %>%
distinct() %>%
group_by(genes, disease_vac) %>%
summarize(median = median(counts), .groups = 'drop') %>%
mutate(disease_vac == "I")
median_i
median_i = table %>%
select(genes, sample, counts, disease_vac) %>%
filter(disease_vac == "H") %>%
distinct() %>%
group_by(genes, disease_vac) %>%
summarize(median = median(counts), .groups = 'drop') %>%
mutate(disease_vac = "I")
median_i
vip_genes_boxplot_type
median_v = table %>%
select(genes, sample, counts, disease_vac) %>%
filter(disease_vac == "H") %>%
distinct() %>%
group_by(genes, disease_vac) %>%
summarize(median = median(counts), .groups = 'drop') %>%
mutate(disease_vac = "V")
median = bind_rows(median_i, median_v)
median
vip_genes_boxplot_type = table %>%
ggplot() +
aes(x = type, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed") +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type
vip_genes_boxplot_type = table %>%
ggplot() +
aes(x = type, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type
vip_genes_boxplot_type
vip_genes_boxplot_type = table %>%
filter(disease_vac != "H") %>%
ggplot() +
aes(x = type, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type
table = df %>%
rownames_to_column("genes") %>%
pivot_longer(cols = -genes,
names_to = "sample",
values_to = "counts") %>%
filter(genes %in% c("GATA3", "ZNF3", "KMT2A", "ASXL1", "SP100", "GZMM","ITGAM", "ACTG1", "LGALS3", "STAT5B")) %>%
inner_join(ann_vaccines_samples_4_12_23, by = "sample") %>%
mutate(week_fac = as_factor(week),
week_fac = fct_reorder(week_fac, week))
#Base value -----
median_h = table %>%
select(genes, sample, counts, disease_vac) %>%
filter(disease_vac == "H") %>%
distinct() %>%
group_by(genes, disease_vac) %>%
summarize(median = median(counts), .groups = 'drop')
median_i = table %>%
select(genes, sample, counts, disease_vac) %>%
filter(disease_vac == "H") %>%
distinct() %>%
group_by(genes, disease_vac) %>%
summarize(median = median(counts), .groups = 'drop') %>%
mutate(disease_vac = "I")
median_v = table %>%
select(genes, sample, counts, disease_vac) %>%
filter(disease_vac == "H") %>%
distinct() %>%
group_by(genes, disease_vac) %>%
summarize(median = median(counts), .groups = 'drop') %>%
mutate(disease_vac = "V")
median = bind_rows(median_i, median_v)
vip_genes_boxplot_week = table %>%
ggplot() +
aes(x = week_fac, y = counts, fill = type,label = condition) +
geom_boxplot() +
scale_y_log10()+
scale_fill_brewer(palette = "Set2", direction = 1) +
scale_color_brewer(palette = "Set2", direction = 1) +
theme_light() +
facet_wrap(vars(genes), scales = "free", ncol = 1)
vip_genes_boxplot_type = table %>%
filter(disease_vac != "H") %>%
ggplot() +
aes(x = type, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type
table = df %>%
rownames_to_column("genes") %>%
pivot_longer(cols = -genes,
names_to = "sample",
values_to = "counts") %>%
filter(genes %in% c("GATA3", "ZNF3", "KMT2A", "ASXL1", "SP100", "GZMM","ITGAM", "ACTG1", "LGALS3", "STAT5B")) %>%
inner_join(ann_vaccines_samples_4_12_23, by = "sample") %>%
mutate(week_fac = as_factor(week),
week_fac = fct_reorder(week_fac, week),
type = fct_relevel(type, "H",  "I","RNA", "VV", "IN", "SU"))
table = df %>%
rownames_to_column("genes") %>%
pivot_longer(cols = -genes,
names_to = "sample",
values_to = "counts") %>%
filter(genes %in% c("GATA3", "ZNF3", "KMT2A", "ASXL1", "SP100", "GZMM","ITGAM", "ACTG1", "LGALS3", "STAT5B")) %>%
inner_join(ann_vaccines_samples_4_12_23, by = "sample") %>%
mutate(week_fac = as_factor(week),
week_fac = fct_reorder(week_fac, week),
type = fct_relevel(type, "H",  "I","RNA", "VV", "IN", "SU"))
#Base value -----
median_h = table %>%
select(genes, sample, counts, disease_vac) %>%
filter(disease_vac == "H") %>%
distinct() %>%
group_by(genes, disease_vac) %>%
summarize(median = median(counts), .groups = 'drop')
median_i = table %>%
select(genes, sample, counts, disease_vac) %>%
filter(disease_vac == "H") %>%
distinct() %>%
group_by(genes, disease_vac) %>%
summarize(median = median(counts), .groups = 'drop') %>%
mutate(disease_vac = "I")
median_v = table %>%
select(genes, sample, counts, disease_vac) %>%
filter(disease_vac == "H") %>%
distinct() %>%
group_by(genes, disease_vac) %>%
summarize(median = median(counts), .groups = 'drop') %>%
mutate(disease_vac = "V")
median = bind_rows(median_i, median_v)
#Plots -----
vip_genes_boxplot_week = table %>%
ggplot() +
aes(x = week_fac, y = counts, fill = type,label = condition) +
geom_boxplot() +
scale_y_log10()+
scale_fill_brewer(palette = "Set2", direction = 1) +
scale_color_brewer(palette = "Set2", direction = 1) +
theme_light() +
facet_wrap(vars(genes), scales = "free", ncol = 1)
vip_genes_boxplot_type = table %>%
filter(disease_vac != "H") %>%
ggplot() +
aes(x = type, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type
vip_genes_boxplot_type %>% ggsave(file = here("Figures", paste0("vip_genes_boxplot_type", filename, outcomevar, today, ".png")), width = 10, height = 15)
vip_genes_boxplot_type
vip_genes_boxplot_type %>% ggsave(file = here("Figures", paste0("vip_genes_boxplot_type", filename, outcomevar, today, ".png")),
width = 10, height = 15)
vip_genes_boxplot_type %>%
ggsave(file = here("Figures", paste0("vip_genes_boxplot_type", filename, outcomevar, today, ".png")),
width = 10, height = 15)
vip_genes_boxplot_type %>%
ggsave(file = here("Figures", paste0("vip_genes_boxplot_type", filename, outcomevar, today(), ".png")),
width = 10, height = 15)
table
table %>%
mutate(type_sex = paste0(type, "_", sex))
vip_genes_boxplot_type_sex = table %>%
mutate(type_sex = paste0(type, "_", sex)) %>%
filter(disease_vac != "H") %>%
ggplot() +
aes(x = type_sex, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type_sex
vip_genes_boxplot_type_sex = table %>%
mutate(type_sex = paste0(type, "_", sex),
type_sex = fct_relevel(type_sex, "IN_M/F", "SU_M/F")) %>%
filter(disease_vac != "H") %>%
ggplot() +
aes(x = type_sex, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type_sex
vip_genes_boxplot_type_sex = table %>%
mutate(type_sex = paste0(type, "_", sex),
type_sex = fct_relevel(type_sex, "IN_M/F", "SU_M/F")) %>%
filter(disease_vac != "H") %>%
ggplot() +
aes(x = type_sex, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1),
axis.text.x = element_text(angle = 45, vjust = 1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type_sex
vip_genes_boxplot_type_sex = table %>%
mutate(type_sex = paste0(type, "_", sex),
type_sex = fct_relevel(type_sex, "IN_M/F", "SU_M/F")) %>%
filter(disease_vac != "H") %>%
ggplot() +
aes(x = type_sex, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1),
axis.text.x = element_text(angle = 45, vjust = -1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type_sex
vip_genes_boxplot_type_sex = table %>%
mutate(type_sex = paste0(type, "_", sex),
type_sex = fct_relevel(type_sex, "IN_M/F", "SU_M/F")) %>%
filter(disease_vac != "H") %>%
ggplot() +
aes(x = type_sex, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1),
axis.text.x = element_text(angle = 45, vjust = 0.2)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type_sex
vip_genes_boxplot_type_sex = table %>%
mutate(type_sex = paste0(type, "_", sex),
type_sex = fct_relevel(type_sex, "IN_M/F", "SU_M/F")) %>%
filter(disease_vac != "H") %>%
ggplot() +
aes(x = type_sex, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1),
axis.text.x = element_text(angle = 45, vjust = 0)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type_sex
vip_genes_boxplot_type_sex = table %>%
mutate(type_sex = paste0(type, "_", sex),
type_sex = fct_relevel(type_sex, "IN_M/F", "SU_M/F")) %>%
filter(disease_vac != "H") %>%
ggplot() +
aes(x = type_sex, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1),
axis.text.x = element_text(angle = 45, vjust = 0, hjust = 1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type_sex
vip_genes_boxplot_type_sex = table %>%
mutate(type_sex = paste0(type, "_", sex),
type_sex = fct_relevel(type_sex, "IN_M/F", "SU_M/F")) %>%
filter(disease_vac != "H") %>%
ggplot() +
aes(x = type_sex, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1),
axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type_sex
vip_genes_boxplot_type_sex = table %>%
mutate(type_sex = paste0(type, "_", sex),
type_sex = fct_relevel(type_sex, "IN_M/F", "SU_M/F")) %>%
filter(disease_vac != "H") %>%
ggplot() +
aes(x = type_sex, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1),
axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type_sex
vip_genes_boxplot_type = table %>%
filter(disease_vac != "H") %>%
ggplot() +
aes(x = type, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1),
legend.position = "top") +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type
vip_genes_boxplot_type %>%
ggsave(file = here("Figures", paste0("vip_genes_boxplot_type", filename, outcomevar, today(), ".png")),
width = 10, height = 15)
vip_genes_boxplot_type_sex
#Sex
vip_genes_boxplot_type_sex = table %>%
mutate(type_sex = paste0(type, "_", sex),
type_sex = fct_relevel(type_sex, "IN_M/F", "SU_M/F")) %>%
filter(disease_vac != "H",
!type %in% c("IN", "SU")) %>%
ggplot() +
aes(x = type_sex, y = counts, fill = week_fac) +
geom_boxplot() +
geom_hline(data = median, aes(yintercept = median), linetype = "dashed", alpha = 0.5) +
scale_fill_viridis_d(option = "cividis", direction = -1) +
scale_y_continuous(trans = "log10") +
labs(
x = "Type",
y = "Normalized counts",
title = "Gene expression of the 5 most important genes",
fill = "Week"
) +
theme_linedraw() +
theme(axis.text.y = element_text(hjust = 0.1),
axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
facet_grid(~genes~disease_vac, scales = "free")
vip_genes_boxplot_type_sex
`ImmuneGO_Annotated_GO_2024-03-26` <- readRDS("~/Desktop/Github - Covid Atlas/VaxGO gene sets/ImmuneGO_Annotated_GO_2024-03-26.rds")
`ImmuneGO_Annotated_GO_2024-03-26`
view(`ImmuneGO_Annotated_GO_2024-03-26`)
`ImmuneGO_Annotated_GO_2024-03-26` %>% group_by(process) %>%
summarise(genes = str_c(genes, collapse = ","))
ImmuneGO_Annotated_GO_2024_03_26 %>%
group_by(process) %>%
mutate(genes= str_c(genes, collapse = ",")) %>%
ungroup() %>%
distinct()
"ImmuneGO_Annotated_GO_2024-03-26" %>%
group_by(process) %>%
mutate(genes= str_c(genes, collapse = ",")) %>%
ungroup() %>%
distinct()
`ImmuneGO_Annotated_GO_2024-03-26` %>%
group_by(process) %>%
mutate(genes= str_c(genes, collapse = ",")) %>%
ungroup() %>%
distinct()
ImmuneGO_Annotated_GO = `ImmuneGO_Annotated_GO_2024-03-26` %>%
group_by(process) %>%
mutate(genes= str_c(genes, collapse = ",")) %>%
ungroup() %>%
distinct()
ImmuneGO_Annotated_GO
view(ImmuneGO_Annotated_GO)
ImmuneGO_Annotated_GO %>% write.csv(here("VaxGO gene sets", "ImmuneGO_Annotated_GO_2024_03_26.csv"), row.names = F)
library(readr)
CellMarker_ImmuneCells <- read_csv("VaxGO gene sets/CellMarker_ImmuneCells.csv")
View(CellMarker_ImmuneCells)
CellMarker_ImmuneCells %>% select(-"...1") %>%  write.csv(file = here("VaxGO gene sets", "CellMarker_ImmuneCells.csv"), row.names = F)
CellMarker_ImmuneCells %>% select(-"...1")  %>% group_by(cell_name) %>%
mutate(marker= str_c(marker, collapse = ",")) %>%
ungroup() %>%
distinct() %>%  write.csv(file = here("VaxGO gene sets", "CellMarker_ImmuneCells.csv"), row.names = F)
CellMarker_ImmuneCells %>%
select(-"...1")  %>%
group_by(cell_name) %>%
mutate(marker= str_c(marker, collapse = ",")) %>%
ungroup() %>%
distinct() %>%
write.csv(file = here("VaxGO gene sets", "CellMarker_ImmuneCells_grouped.csv"), row.names = F)
library(readr)
CellMarker_ImmuneCells_grouped <- read_csv("VaxGO gene sets/CellMarker_ImmuneCells_grouped.csv")
View(CellMarker_ImmuneCells_grouped)
CellMarker_ImmuneCells %>%
select(-"...1")  %>%
write.csv(file = here("VaxGO gene sets", "CellMarker_ImmuneCells.csv"), row.names = F)
