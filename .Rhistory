arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(disease_vac == "V",
str_detect(condition, "^BNT \\(V1, D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(disease_vac == "V",
!str_detect(condition, "^BNT \\(V1, D\\d+\\)"),
!str_detect(condition, "BBIBP"),
!str_detect(condition, "ZF2001")) %>%
arrange(condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(str_detect(condition, "BBIBP")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(str_detect(condition, "ZF2001")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition))) %>%
mutate(type = if_else(type == "H", "I", type),
disease_vac = if_else(disease_vac == "H", "I", disease_vac))
nesmat_result_CellMarker_1 = nesmat_result_CellMarker %>%
distinct() %>%
filter(condition != "BNT-MO (V1, D0)",
condition != "BNT-MO (V1, D6)") %>%
mutate(disease_vac = if_else(disease_vac == "Healthy", "H", disease_vac)) %>%
mutate(disease_vac = fct_relevel(disease_vac, "H", "I", "V"),
type = fct_relevel(type, "I", "RNA", "VV", "IN", "SU")) %>%
arrange(disease_vac,type, condition) %>%
inner_join(ann_vaccines_conditions %>% select(condition, samples), by = "condition") %>%
mutate(condition = factor(condition, levels = c(unique(condition[order(condition)]))),
condition = paste0(condition, " (n=", samples, ")"))
nesmat_result_CellMarker_2 = nesmat_result_CellMarker_1 %>%
mutate(condition = fct_relevel(condition,
nesmat_result_CellMarker_1 %>%
filter(str_detect(condition, "^H \\(D0\\)")) %>%
select(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(str_detect(condition, "^I")) %>%
filter(!str_detect(condition, "^I-I")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(disease_vac == "I") %>%
filter(str_detect(condition, "^BNT-I")) %>%
filter(!str_detect(condition, "^BNT-I \\(D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(str_detect(condition, "^BNT-I \\(D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(disease_vac == "V",
str_detect(condition, "^BNT \\(V1, D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(disease_vac == "V",
!str_detect(condition, "^BNT \\(V1, D\\d+\\)"),
!str_detect(condition, "BBIBP"),
!str_detect(condition, "ZF2001")) %>%
arrange(condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(str_detect(condition, "BBIBP")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(str_detect(condition, "ZF2001")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition))) %>%
mutate(type = if_else(type == "H", "I", type),
disease_vac = if_else(disease_vac == "H", "I", disease_vac))
df_annotated = df_samples_l2fc_vipgenes_covid %>%
distinct() %>%
inner_join(ann_vaccines_samples %>% select(-condition, -participant_id), by = "sample") %>%
distinct() %>%
filter(condition != "BNT-MO (V1, D0)",
condition != "BNT-MO (V1, D6)") %>%
mutate(disease_vac = if_else(disease_vac == "Healthy", "H", disease_vac)) %>%
mutate(disease_vac = fct_relevel(disease_vac, "H", "I", "V"),
type = fct_relevel(type, "I", "RNA", "VV", "IN", "SU")) %>%
arrange(disease_vac,type, condition) %>%
mutate(condition = factor(condition, levels = c(unique(condition[order(condition)]))))
df_annotated
ann_vaccines_samples <- read_csv(here("Annotations and metadata", "ann_vaccines_samples.csv"))
df_annotated = df_samples_l2fc_vipgenes_covid %>%
distinct() %>%
inner_join(ann_vaccines_samples %>% select(-condition, -participant_id), by = "sample") %>%
distinct() %>%
filter(condition != "BNT-MO (V1, D0)",
condition != "BNT-MO (V1, D6)") %>%
mutate(disease_vac = if_else(disease_vac == "Healthy", "H", disease_vac)) %>%
mutate(disease_vac = fct_relevel(disease_vac, "H", "I", "V"),
type = fct_relevel(type, "I", "RNA", "VV", "IN", "SU")) %>%
arrange(disease_vac,type, condition) %>%
mutate(condition = factor(condition, levels = c(unique(condition[order(condition)]))))
df_annotated
df_annotated %>%
filter(str_detect(condition, "^H \\(D0\\)")) %>%
select(condition) %>%
distinct() %>%
pull(condition)
df_annotated %>%
filter(str_detect(condition, "^I")) %>%
filter(!str_detect(condition, "^I-I")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition)
df_annotated %>%
filter(disease_vac == "I") %>%
filter(str_detect(condition, "^BNT-I")) %>%
filter(!str_detect(condition, "^BNT-I \\(D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition)
df_annotated %>%
filter(str_detect(condition, "^BNT-I \\(D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition)
df_annotated %>%
filter(disease_vac == "V",
str_detect(condition, "^BNT \\(V1, D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition)
df_annotated %>%
filter(disease_vac == "V",
!str_detect(condition, "^BNT \\(V1, D\\d+\\)"),
!str_detect(condition, "BBIBP"),
!str_detect(condition, "ZF2001")) %>%
arrange(condition) %>%
select(condition) %>%
distinct() %>%
pull(condition)
df_annotated %>%
filter(str_detect(condition, "BBIBP")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition)
df_annotated %>%
filter(disease_vac == "V",
!str_detect(condition, "^BNT \\(V1, D\\d+\\)"),
!str_detect(condition, "BBIBP"),
!str_detect(condition, "ZF2001")) %>%
arrange(condition) %>%
select(condition) %>%
distinct() %>%
pull(condition)
df_annotated %>%
filter(str_detect(condition, "BBIBP")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition)
df_annotated %>%
filter(str_detect(condition, "ZF2001")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition)))
df_annotated %>%
filter(str_detect(condition, "ZF2001")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition))
df_annotated %>%
filter(str_detect(condition, "ZF2001")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition)
df_annotated %>%
mutate(condition = fct_relevel(condition,
df_annotated %>%
filter(str_detect(condition, "^H \\(D0\\)")) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(str_detect(condition, "^I")) %>%
filter(!str_detect(condition, "^I-I")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(disease_vac == "I") %>%
filter(str_detect(condition, "^BNT-I")) %>%
filter(!str_detect(condition, "^BNT-I \\(D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(str_detect(condition, "^BNT-I \\(D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(disease_vac == "V",
str_detect(condition, "^BNT \\(V1, D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(disease_vac == "V",
!str_detect(condition, "^BNT \\(V1, D\\d+\\)"),
!str_detect(condition, "BBIBP"),
!str_detect(condition, "ZF2001")) %>%
arrange(condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(str_detect(condition, "BBIBP")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(str_detect(condition, "ZF2001")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition)))
df_annotated = df_samples_l2fc_vipgenes_covid %>%
distinct() %>%
inner_join(ann_vaccines_samples %>% select(-condition, -participant_id), by = "sample") %>%
distinct() %>%
filter(condition != "BNT-MO (V1, D0)",
condition != "BNT-MO (V1, D6)") %>%
mutate(disease_vac = if_else(disease_vac == "Healthy", "H", disease_vac)) %>%
mutate(disease_vac = fct_relevel(disease_vac, "H", "I", "V"),
type = fct_relevel(type, "I", "RNA", "VV", "IN", "SU")) %>%
arrange(disease_vac,type, condition) %>%
mutate(condition = factor(condition, levels = c(unique(condition[order(condition)]))))
df_annotated
df_annotated = df_samples_l2fc_vipgenes_covid %>%
filter(genes == "GZMM") %>%
distinct() %>%
inner_join(ann_vaccines_samples %>% select(-condition, -participant_id), by = "sample") %>%
distinct() %>%
filter(condition != "BNT-MO (V1, D0)",
condition != "BNT-MO (V1, D6)") %>%
mutate(disease_vac = if_else(disease_vac == "Healthy", "H", disease_vac)) %>%
mutate(disease_vac = fct_relevel(disease_vac, "H", "I", "V"),
type = fct_relevel(type, "I", "RNA", "VV", "IN", "SU")) %>%
arrange(disease_vac,type, condition) %>%
mutate(condition = factor(condition, levels = c(unique(condition[order(condition)]))))
df_annotated_2 = df_annotated %>%
mutate(condition = fct_relevel(condition,
df_annotated %>%
filter(str_detect(condition, "^H \\(D0\\)")) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(str_detect(condition, "^I")) %>%
filter(!str_detect(condition, "^I-I")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(disease_vac == "I") %>%
filter(str_detect(condition, "^BNT-I")) %>%
filter(!str_detect(condition, "^BNT-I \\(D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(str_detect(condition, "^BNT-I \\(D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(disease_vac == "V",
str_detect(condition, "^BNT \\(V1, D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(disease_vac == "V",
!str_detect(condition, "^BNT \\(V1, D\\d+\\)"),
!str_detect(condition, "BBIBP"),
!str_detect(condition, "ZF2001")) %>%
arrange(condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(str_detect(condition, "BBIBP")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(str_detect(condition, "ZF2001")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition))) %>%
mutate(type = if_else(type == "H", "I", type),
disease_vac = if_else(disease_vac == "H", "I", disease_vac))
nesmat_result_CellMarker_1 = nesmat_result_CellMarker %>%
distinct() %>%
filter(condition != "BNT-MO (V1, D0)",
condition != "BNT-MO (V1, D6)") %>%
mutate(disease_vac = if_else(disease_vac == "Healthy", "H", disease_vac)) %>%
mutate(disease_vac = fct_relevel(disease_vac, "H", "I", "V"),
type = fct_relevel(type, "I", "RNA", "VV", "IN", "SU")) %>%
arrange(disease_vac,type, condition) %>%
inner_join(ann_vaccines_conditions %>% select(condition, samples), by = "condition") %>%
mutate(condition = factor(condition, levels = c(unique(condition[order(condition)]))))
nesmat_result_CellMarker_2 = nesmat_result_CellMarker_1 %>%
mutate(condition = fct_relevel(condition,
nesmat_result_CellMarker_1 %>%
filter(str_detect(condition, "^H \\(D0\\)")) %>%
select(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(str_detect(condition, "^I")) %>%
filter(!str_detect(condition, "^I-I")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(disease_vac == "I") %>%
filter(str_detect(condition, "^BNT-I")) %>%
filter(!str_detect(condition, "^BNT-I \\(D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(str_detect(condition, "^BNT-I \\(D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(disease_vac == "V",
str_detect(condition, "^BNT \\(V1, D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(disease_vac == "V",
!str_detect(condition, "^BNT \\(V1, D\\d+\\)"),
!str_detect(condition, "BBIBP"),
!str_detect(condition, "ZF2001")) %>%
arrange(condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(str_detect(condition, "BBIBP")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition),
nesmat_result_CellMarker_1 %>%
filter(str_detect(condition, "ZF2001")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition))) %>%
mutate(type = if_else(type == "H", "I", type),
disease_vac = if_else(disease_vac == "H", "I", disease_vac))
df_annotated = df_samples_l2fc_vipgenes_covid %>%
distinct() %>%
inner_join(ann_vaccines_samples %>% select(-condition, -participant_id), by = "sample") %>%
distinct() %>%
filter(condition != "BNT-MO (V1, D0)",
condition != "BNT-MO (V1, D6)") %>%
mutate(disease_vac = if_else(disease_vac == "Healthy", "H", disease_vac)) %>%
mutate(disease_vac = fct_relevel(disease_vac, "H", "I", "V"),
type = fct_relevel(type, "I", "RNA", "VV", "IN", "SU")) %>%
mutate(condition = factor(condition, levels = c(unique(condition[order(condition)]))),
condition = paste0(condition, " (n=", samples, ")"))
df_annotated = df_samples_l2fc_vipgenes_covid %>%
distinct() %>%
inner_join(ann_vaccines_samples %>% select(-condition, -participant_id), by = "sample") %>%
distinct() %>%
filter(condition != "BNT-MO (V1, D0)",
condition != "BNT-MO (V1, D6)") %>%
mutate(disease_vac = if_else(disease_vac == "Healthy", "H", disease_vac)) %>%
mutate(disease_vac = fct_relevel(disease_vac, "H", "I", "V"),
type = fct_relevel(type, "I", "RNA", "VV", "IN", "SU")) %>%
mutate(condition = factor(condition, levels = c(unique(condition[order(condition)]))),
condition = paste0(condition, " (n=", sample, ")"))
df_annotated
ann_vaccines_conditions
df_annotated = df_samples_l2fc_vipgenes_covid %>%
distinct() %>%
inner_join(ann_vaccines_samples %>% select(-condition, -participant_id), by = "sample") %>%
distinct() %>%
filter(condition != "BNT-MO (V1, D0)",
condition != "BNT-MO (V1, D6)") %>%
mutate(disease_vac = if_else(disease_vac == "Healthy", "H", disease_vac)) %>%
mutate(disease_vac = fct_relevel(disease_vac, "H", "I", "V"),
type = fct_relevel(type, "I", "RNA", "VV", "IN", "SU")) %>%
inner_join(ann_vaccines_conditions %>% select(condition, samples), by = "condition") %>%
mutate(condition = factor(condition, levels = c(unique(condition[order(condition)]))),
condition = paste0(condition, " (n=", samples, ")"))
df_annotated_2 = df_annotated %>%
mutate(condition = fct_relevel(condition,
df_annotated %>%
filter(str_detect(condition, "^H \\(D0\\)")) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(str_detect(condition, "^I")) %>%
filter(!str_detect(condition, "^I-I")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(disease_vac == "I") %>%
filter(str_detect(condition, "^BNT-I")) %>%
filter(!str_detect(condition, "^BNT-I \\(D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(str_detect(condition, "^BNT-I \\(D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(disease_vac == "V",
str_detect(condition, "^BNT \\(V1, D\\d+\\)")) %>%
arrange(day, condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(disease_vac == "V",
!str_detect(condition, "^BNT \\(V1, D\\d+\\)"),
!str_detect(condition, "BBIBP"),
!str_detect(condition, "ZF2001")) %>%
arrange(condition) %>%
select(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(str_detect(condition, "BBIBP")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition),
df_annotated %>%
filter(str_detect(condition, "ZF2001")) %>%
select(condition) %>%
arrange(condition) %>%
distinct() %>%
pull(condition))) %>%
mutate(type = if_else(type == "H", "I", type),
disease_vac = if_else(disease_vac == "H", "I", disease_vac))
df_annotated_2
df_annotated_2 %>%
esquisser()
