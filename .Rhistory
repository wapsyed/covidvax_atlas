facet_grid(vars(direction),  vars(term_ancestor)) +
scale_fill_manual(name = "Type",
values = c('IN'= "#00A087FF", #1st Gen  vaccines
'VV' = "#3C5488FF", #3rd Gen vaccines
'RNA' = "#4DBBD5FF",
'SU' = "#8491B4FF",
'I'= "#DC0000FF",
"H" = "grey95")) +
theme(legend.position = "right",
legend.title = element_text(size = 15),
legend.text =element_text(size=15),
axis.text.x = element_text(size = 12, color = "black", angle = 0, hjust = 1),
axis.text.y = element_text(size = 12, color = "black", angle = 0, hjust = 1),
strip.text.x = element_text(size = 20, color = "white", hjust = 0.5),
strip.text.y = element_text(size = 20, angle = 0, color = "white", face = "bold"),
strip.background.x = element_rect(
fill = "white",
color = "white",
linewidth = 1 ),
strip.background.y = element_rect(
fill = "#DC0000FF",
color = "#DC0000FF",
linewidth = 1 )
) +
geom_text(aes(label = paste0(n_genes_perc, "% (", n_genes, ")"),
y = n_genes_perc),
hjust = 0,
size = 4,
angle = 0) +
labs(title = "",
x = "",
y = "") +
ylim(0,120)
#DOWN regulated
main_go_2_plot_down = main_go_2 %>%
mutate(direction = if_else(direction == "UP", "↑", "↓"),
term_ancestor = fct_relevel(term_ancestor, "Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
filter(direction == "↓",
term_ancestor %in% c("Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
ggplot() +
aes(x = forcats::fct_rev(factor(condition)), y = n_genes_perc, fill = type) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(legend.position = "top") +
facet_grid(vars(direction),  vars(term_ancestor)) +
scale_fill_manual(name = "Type",
values = c('IN'= "#00A087FF", #1st Gen  vaccines
'VV' = "#3C5488FF", #3rd Gen vaccines
'RNA' = "#4DBBD5FF",
'SU' = "#8491B4FF",
'I'= "#DC0000FF",
"H" = "grey95")) +
theme(legend.position = "right",
legend.title = element_text(size = 15),
legend.text =element_text(size=15),
axis.text.x = element_text(size = 12, color = "black", angle = 0, hjust = 1),
axis.text.y = element_text(size = 12, color = "black", angle = 0, hjust = 1),
strip.text.x = element_blank(),
strip.text.y = element_text(size = 20, angle = 0, color = "black", face = "bold"),
strip.background.x = element_blank(),
strip.background.y = element_rect(
fill = "#4DBBD5FF",
color = "#4DBBD5FF",
linewidth = 1)
) +
geom_text(aes(label = paste0(n_genes_perc, "% (", n_genes, ")"),
y = n_genes_perc),
hjust = 0,
size = 4,
angle = 0) +
labs(x = "",
y = "Number of genes (%)") +
ylim(0,120)
main_go_2_plot_down
patch = (main_go_2_plot_up/main_go_2_plot_down) + plot_layout(guides = "collect")
ggsave(patch, file = "main_go_2_plot_values_UP_DOWN_regulated.png", width = 20, height = 15)
### Bar plot by term (United) -----
main_go_2 = degs_annotated_mainGOs_stats
main_go_2_plot = main_go_2 %>%
mutate(direction = if_else(direction == "UP", "↑", "↓"),
term_ancestor = fct_relevel(term_ancestor, "Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
filter(term_ancestor %in% c("Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
ggplot() +
aes(x = forcats::fct_rev(factor(condition)), y = n_genes_perc, fill = type) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(legend.position = "top") +
facet_grid(vars(direction),  vars(term_ancestor)) +
scale_fill_manual(name = "Type",
values = c('IN'= "#00A087FF", #1st Gen  vaccines
'VV' = "#3C5488FF", #3rd Gen vaccines
'RNA' = "#4DBBD5FF",
'SU' = "#8491B4FF",
'I'= "#DC0000FF",
"H" = "grey95")) +
theme(legend.position = "right",
legend.title = element_text(size = 15),
legend.text =element_text(size=15),
axis.text.x = element_text(size = 12, color = "black", angle = 0, hjust = 1),
axis.text.y = element_text(size = 12, color = "black", angle = 0, hjust = 1),
strip.text.x = element_text(size = 12, color = "white", hjust = 0.5),
strip.text.y = element_text(size = 15, angle = 0),
strip.background.x = element_rect(
fill = "black",
color = "black",
linewidth = 1 ),
strip.background.y = element_rect(
fill = "gray70",
color = "gray70",
linewidth = 1 )
) +
geom_text(aes(label = paste0(n_genes_perc, "% (", n_genes, ")"),
y = n_genes_perc),
hjust = 0,
size = 3,
angle = 0) +
labs(title = "DEGs by Biological Process",
x = "",
y = "Number of genes (%)") +
ylim(0,120)
main_go_2_plot
ggsave(main_go_2_plot, file = "main_go_2_plot_values.png", width = 20, height = 15)
### Bar plot by term (Divided) -----
#UP regulated
main_go_2_plot_up = main_go_2 %>%
mutate(direction = if_else(direction == "UP", "↑", "↓"),
term_ancestor = fct_relevel(term_ancestor, "Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
filter(direction == "↑",
term_ancestor %in% c("Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
ggplot() +
aes(x = forcats::fct_rev(factor(condition)), y = n_genes_perc, fill = type) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(legend.position = "top") +
facet_grid(vars(direction),  vars(term_ancestor)) +
scale_fill_manual(name = "Type",
values = c('IN'= "#00A087FF", #1st Gen  vaccines
'VV' = "#3C5488FF", #3rd Gen vaccines
'RNA' = "#4DBBD5FF",
'SU' = "#8491B4FF",
'I'= "#DC0000FF",
"H" = "grey95")) +
theme(legend.position = "right",
legend.title = element_text(size = 15),
legend.text =element_text(size=15),
axis.text.x = element_text(size = 12, color = "black", angle = 0, hjust = 1),
axis.text.y = element_text(size = 12, color = "black", angle = 0, hjust = 1),
strip.text.x = element_text(size = 20, color = "black", hjust = 0.5),
strip.text.y = element_text(size = 20, angle = 0, color = "white", face = "bold"),
strip.background.x = element_rect(
fill = "white",
color = "white",
linewidth = 1 ),
strip.background.y = element_rect(
fill = "#DC0000FF",
color = "#DC0000FF",
linewidth = 1 )
) +
geom_text(aes(label = paste0(n_genes_perc, "% (", n_genes, ")"),
y = n_genes_perc),
hjust = 0,
size = 4,
angle = 0) +
labs(title = "",
x = "",
y = "") +
ylim(0,120)
#DOWN regulated
main_go_2_plot_down = main_go_2 %>%
mutate(direction = if_else(direction == "UP", "↑", "↓"),
term_ancestor = fct_relevel(term_ancestor, "Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
filter(direction == "↓",
term_ancestor %in% c("Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
ggplot() +
aes(x = forcats::fct_rev(factor(condition)), y = n_genes_perc, fill = type) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(legend.position = "top") +
facet_grid(vars(direction),  vars(term_ancestor)) +
scale_fill_manual(name = "Type",
values = c('IN'= "#00A087FF", #1st Gen  vaccines
'VV' = "#3C5488FF", #3rd Gen vaccines
'RNA' = "#4DBBD5FF",
'SU' = "#8491B4FF",
'I'= "#DC0000FF",
"H" = "grey95")) +
theme(legend.position = "right",
legend.title = element_text(size = 15),
legend.text =element_text(size=15),
axis.text.x = element_text(size = 12, color = "black", angle = 0, hjust = 1),
axis.text.y = element_text(size = 12, color = "black", angle = 0, hjust = 1),
strip.text.x = element_blank(),
strip.text.y = element_text(size = 20, angle = 0, color = "black", face = "bold"),
strip.background.x = element_blank(),
strip.background.y = element_rect(
fill = "#4DBBD5FF",
color = "#4DBBD5FF",
linewidth = 1)
) +
geom_text(aes(label = paste0(n_genes_perc, "% (", n_genes, ")"),
y = n_genes_perc),
hjust = 0,
size = 4,
angle = 0) +
labs(x = "",
y = "Number of genes (%)") +
ylim(0,120)
main_go_2_plot_down
patch = (main_go_2_plot_up/main_go_2_plot_down) + plot_layout(guides = "collect")
ggsave(patch, file = "main_go_2_plot_values_UP_DOWN_regulated.png", width = 20, height = 15)
### Bar plot by term (United) -----
main_go_2 = degs_annotated_mainGOs_stats
main_go_2_plot = main_go_2 %>%
mutate(direction = if_else(direction == "UP", "↑", "↓"),
term_ancestor = fct_relevel(term_ancestor, "Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
filter(term_ancestor %in% c("Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
ggplot() +
aes(x = forcats::fct_rev(factor(condition)), y = n_genes_perc, fill = type) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(legend.position = "top") +
facet_grid(vars(direction),  vars(term_ancestor)) +
scale_fill_manual(name = "Type",
values = c('IN'= "#00A087FF", #1st Gen  vaccines
'VV' = "#3C5488FF", #3rd Gen vaccines
'RNA' = "#4DBBD5FF",
'SU' = "#8491B4FF",
'I'= "#DC0000FF",
"H" = "grey95")) +
theme(legend.position = "right",
legend.title = element_text(size = 15),
legend.text =element_text(size=15),
axis.text.x = element_text(size = 12, color = "black", angle = 0, hjust = 1),
axis.text.y = element_text(size = 12, color = "black", angle = 0, hjust = 1),
strip.text.x = element_text(size = 12, color = "white", hjust = 0.5),
strip.text.y = element_text(size = 15, angle = 0),
strip.background.x = element_rect(
fill = "black",
color = "black",
linewidth = 1 ),
strip.background.y = element_rect(
fill = "gray70",
color = "gray70",
linewidth = 1 )
) +
geom_text(aes(label = paste0(n_genes_perc, "% (", n_genes, ")"),
y = n_genes_perc),
hjust = 0,
size = 3,
angle = 0) +
labs(title = "DEGs by Biological Process",
x = "",
y = "Number of genes (%)") +
ylim(0,120)
main_go_2_plot
ggsave(main_go_2_plot, file = "main_go_2_plot_values.png", width = 20, height = 15)
### Bar plot by term (Divided) -----
#UP regulated
main_go_2_plot_up = main_go_2 %>%
mutate(direction = if_else(direction == "UP", "↑", "↓"),
term_ancestor = fct_relevel(term_ancestor, "Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
filter(direction == "↑",
term_ancestor %in% c("Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
ggplot() +
aes(x = forcats::fct_rev(factor(condition)), y = n_genes_perc, fill = type) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(legend.position = "top") +
facet_grid(vars(direction),  vars(term_ancestor)) +
scale_fill_manual(name = "Type",
values = c('IN'= "#00A087FF", #1st Gen  vaccines
'VV' = "#3C5488FF", #3rd Gen vaccines
'RNA' = "#4DBBD5FF",
'SU' = "#8491B4FF",
'I'= "#DC0000FF",
"H" = "grey95")) +
theme(legend.position = "right",
legend.title = element_text(size = 15),
legend.text =element_text(size=15),
axis.text.x = element_text(size = 12, color = "black", angle = 0, hjust = 1),
axis.text.y = element_text(size = 12, color = "black", angle = 0, hjust = 1),
strip.text.x = element_text(size = 20, color = "black", hjust = 0.5. face = "bold"),
main_go_2 = degs_annotated_mainGOs_stats
main_go_2_plot = main_go_2 %>%
mutate(direction = if_else(direction == "UP", "↑", "↓"),
term_ancestor = fct_relevel(term_ancestor, "Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
filter(term_ancestor %in% c("Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
ggplot() +
aes(x = forcats::fct_rev(factor(condition)), y = n_genes_perc, fill = type) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(legend.position = "top") +
facet_grid(vars(direction),  vars(term_ancestor)) +
scale_fill_manual(name = "Type",
values = c('IN'= "#00A087FF", #1st Gen  vaccines
'VV' = "#3C5488FF", #3rd Gen vaccines
'RNA' = "#4DBBD5FF",
'SU' = "#8491B4FF",
'I'= "#DC0000FF",
"H" = "grey95")) +
theme(legend.position = "right",
legend.title = element_text(size = 15),
legend.text =element_text(size=15),
axis.text.x = element_text(size = 12, color = "black", angle = 0, hjust = 1),
axis.text.y = element_text(size = 12, color = "black", angle = 0, hjust = 1),
strip.text.x = element_text(size = 12, color = "white", hjust = 0.5),
strip.text.y = element_text(size = 15, angle = 0),
strip.background.x = element_rect(
fill = "black",
color = "black",
linewidth = 1 ),
strip.background.y = element_rect(
fill = "gray70",
color = "gray70",
linewidth = 1 )
) +
geom_text(aes(label = paste0(n_genes_perc, "% (", n_genes, ")"),
y = n_genes_perc),
hjust = 0,
size = 3,
angle = 0) +
labs(title = "DEGs by Biological Process",
x = "",
y = "Number of genes (%)") +
ylim(0,120)
main_go_2_plot
ggsave(main_go_2_plot, file = "main_go_2_plot_values.png", width = 20, height = 15)
### Bar plot by term (Divided) -----
#UP regulated
main_go_2_plot_up = main_go_2 %>%
mutate(direction = if_else(direction == "UP", "↑", "↓"),
term_ancestor = fct_relevel(term_ancestor, "Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
filter(direction == "↑",
term_ancestor %in% c("Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
ggplot() +
aes(x = forcats::fct_rev(factor(condition)), y = n_genes_perc, fill = type) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(legend.position = "top") +
facet_grid(vars(direction),  vars(term_ancestor)) +
scale_fill_manual(name = "Type",
values = c('IN'= "#00A087FF", #1st Gen  vaccines
'VV' = "#3C5488FF", #3rd Gen vaccines
'RNA' = "#4DBBD5FF",
'SU' = "#8491B4FF",
'I'= "#DC0000FF",
"H" = "grey95")) +
theme(legend.position = "right",
legend.title = element_text(size = 15),
legend.text =element_text(size=15),
axis.text.x = element_text(size = 12, color = "black", angle = 0, hjust = 1),
axis.text.y = element_text(size = 12, color = "black", angle = 0, hjust = 1),
strip.text.x = element_text(size = 20, color = "black", hjust = 0.5, face = "bold"),
strip.text.y = element_text(size = 20, angle = 0, color = "white", face = "bold"),
strip.background.x = element_rect(
fill = "white",
color = "white",
linewidth = 1 ),
strip.background.y = element_rect(
fill = "#DC0000FF",
color = "#DC0000FF",
linewidth = 1 )
) +
geom_text(aes(label = paste0(n_genes_perc, "% (", n_genes, ")"),
y = n_genes_perc),
hjust = 0,
size = 4,
angle = 0) +
labs(title = "",
x = "",
y = "") +
ylim(0,120)
#DOWN regulated
main_go_2_plot_down = main_go_2 %>%
mutate(direction = if_else(direction == "UP", "↑", "↓"),
term_ancestor = fct_relevel(term_ancestor, "Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
filter(direction == "↓",
term_ancestor %in% c("Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
ggplot() +
aes(x = forcats::fct_rev(factor(condition)), y = n_genes_perc, fill = type) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(legend.position = "top") +
facet_grid(vars(direction),  vars(term_ancestor)) +
scale_fill_manual(name = "Type",
values = c('IN'= "#00A087FF", #1st Gen  vaccines
'VV' = "#3C5488FF", #3rd Gen vaccines
'RNA' = "#4DBBD5FF",
'SU' = "#8491B4FF",
'I'= "#DC0000FF",
"H" = "grey95")) +
theme(legend.position = "right",
legend.title = element_text(size = 15),
legend.text =element_text(size=15),
axis.text.x = element_text(size = 12, color = "black", angle = 0, hjust = 1),
axis.text.y = element_text(size = 12, color = "black", angle = 0, hjust = 1),
strip.text.x = element_blank(),
strip.text.y = element_text(size = 20, angle = 0, color = "black", face = "bold"),
strip.background.x = element_blank(),
strip.background.y = element_rect(
fill = "#4DBBD5FF",
color = "#4DBBD5FF",
linewidth = 1)
) +
geom_text(aes(label = paste0(n_genes_perc, "% (", n_genes, ")"),
y = n_genes_perc),
hjust = 0,
size = 4,
angle = 0) +
labs(x = "",
y = "Number of genes (%)") +
ylim(0,120)
main_go_2_plot_down
patch = (main_go_2_plot_up/main_go_2_plot_down) + plot_layout(guides = "collect")
ggsave(patch, file = "main_go_2_plot_values_UP_DOWN_regulated.png", width = 20, height = 15)
main_go_2_plot_up = main_go_2 %>%
mutate(direction = if_else(direction == "UP", "↑", "↓"),
term_ancestor = fct_relevel(term_ancestor, "Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
filter(direction == "↑",
term_ancestor %in% c("Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
ggplot() +
aes(x = forcats::fct_rev(factor(condition)), y = n_genes_perc, fill = type) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(legend.position = "top") +
facet_grid(vars(direction),  vars(term_ancestor)) +
scale_fill_manual(name = "Type",
values = c('IN'= "#00A087FF", #1st Gen  vaccines
'VV' = "#3C5488FF", #3rd Gen vaccines
'RNA' = "#4DBBD5FF",
'SU' = "#8491B4FF",
'I'= "#DC0000FF",
"H" = "grey95")) +
theme(legend.position = "right",
legend.title = element_text(size = 15),
legend.text =element_text(size=15),
axis.text.x = element_text(size = 12, color = "black", angle = 0, hjust = 1),
axis.text.y = element_text(size = 12, color = "black", angle = 0, hjust = 1),
strip.text.x = element_text(size = 20, color = "black", hjust = 0.5, face = "bold"),
strip.text.y = element_text(size = 20, angle = 0, color = "white", face = "bold"),
strip.background.x = element_rect(
fill = "white",
color = "white",
linewidth = 1 ),
strip.background.y = element_rect(
fill = "#DC0000FF",
color = "#DC0000FF",
linewidth = 1 )
) +
geom_text(aes(label = paste0(n_genes_perc, "% (", n_genes, ")"),
y = n_genes_perc),
hjust = 0,
size = 4,
angle = 0) +
labs(title = "",
x = "",
y = "") +
ylim(0,120)
#DOWN regulated
main_go_2_plot_down = main_go_2 %>%
mutate(direction = if_else(direction == "UP", "↑", "↓"),
term_ancestor = fct_relevel(term_ancestor, "Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
filter(direction == "↓",
term_ancestor %in% c("Immune system", "Cellular", "Metabolism", "Reg. of BP")) %>%
ggplot() +
aes(x = forcats::fct_rev(factor(condition)), y = n_genes_perc, fill = type) +
geom_col() +
coord_flip() +
theme_minimal() +
theme(legend.position = "top") +
facet_grid(vars(direction),  vars(term_ancestor)) +
scale_fill_manual(name = "Type",
values = c('IN'= "#00A087FF", #1st Gen  vaccines
'VV' = "#3C5488FF", #3rd Gen vaccines
'RNA' = "#4DBBD5FF",
'SU' = "#8491B4FF",
'I'= "#DC0000FF",
"H" = "grey95")) +
theme(legend.position = "right",
legend.title = element_text(size = 15),
legend.text =element_text(size=15),
axis.text.x = element_text(size = 12, color = "black", angle = 0, hjust = 1),
axis.text.y = element_text(size = 12, color = "black", angle = 0, hjust = 1),
strip.text.x = element_blank(),
strip.text.y = element_text(size = 20, angle = 0, color = "black", face = "bold"),
strip.background.x = element_blank(),
strip.background.y = element_rect(
fill = "#4DBBD5FF",
color = "#4DBBD5FF",
linewidth = 1)
) +
geom_text(aes(label = paste0(n_genes_perc, "% (", n_genes, ")"),
y = n_genes_perc),
hjust = 0,
size = 4,
angle = 0) +
labs(x = "",
y = "Number of genes (%)") +
ylim(0,120)
main_go_2_plot_down
patch = (main_go_2_plot_up/main_go_2_plot_down) + plot_layout(guides = "collect")
ggsave(patch, file = "main_go_2_plot_values_UP_DOWN_regulated.png", width = 20, height = 15)
