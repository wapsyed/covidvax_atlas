pvca_df_plot = ggplot(pvca_df) +
aes(x = batch, y = wavgpv) +
geom_col(fill = "#5e60ce") +
theme_minimal() +
theme(axis.text.x = element_text(size = 20, angle = 45, vjust = 1, hjust=1, color = "black")) +
geom_text(aes(label = round(wavgpv,3), y = wavgpv),
position = position_dodge(width = 0.9),
vjust = -0.2,
hjust = 0.5,
size = 4,
angle = 0)
pvca_df_plot
pvca_df_plot = ggplot(pvca_df) +
aes(x = batch, y = wavgpv) +
geom_col(fill = "#5e60ce") +
theme_minimal() +
theme(axis.text.x = element_text(size = 20, angle = 45, vjust = 1, hjust=1, color = "black"),
axis.text.y = element_text(size = 20, vjust = 1, hjust=1, color = "black")) +
geom_text(aes(label = round(wavgpv,3), y = wavgpv),
position = position_dodge(width = 0.9),
vjust = -0.2,
hjust = 0.5,
size = 4,
angle = 0)
pvca_df_plot
ggsave(pvca_df_plot, file = "pvca_raw_normalized.png", width = 12, height = 10)
pvca_df_plot = ggplot(pvca_df) +
aes(x = batch, y = wavgpv) +
geom_col(fill = "#5e60ce") +
theme_minimal() +
theme(axis.text.x = element_text(size = 20, angle = 45, vjust = 1, hjust=1, color = "black"),
axis.title.x = element_text(size = 20,  color = "black"))
ggsave(pvca_df_plot, file = "pvca_log2foldchange.png", width = 12, height = 10)
# Input
cvrts_eff_var = c("day", "dose", "prior_infection", "previous_vaccination", "severity", "disease_vac", "regimen", "type" )
inpData <- expSetobj(exprs, cvrts)
pct_thrsh <- 0.75
pvca = pvcAnaly(inpData, pct_thrsh, cvrts_eff_var)
# Input
cvrts_eff_var = c("day","age", "sex", "dose", "type", "regimen")
inpData <- expSetobj(exprs, cvrts)
pct_thrsh <- 0.75
pvca = pvcAnaly(inpData, pct_thrsh, cvrts_eff_var)
pvca = pvcAnaly(inpData, pct_thrsh, cvrts_eff_var)
pvca = pvcAnaly(inpData, pct_thrsh, cvrts_eff_var)
pvca_df = pvca$dat %>%
as.data.frame() %>%
t() %>%
as.data.frame() %>%
rename(wavgpv = V1) %>%
cbind(pvca$label %>% as.data.frame() %>% rename(batch = '.')) %>%
as.data.frame() %>%
mutate(batch = as.factor(batch),
wavgpv = as.numeric(wavgpv),
batch = fct_rev(fct_reorder(batch, wavgpv))) %>%
arrange(batch, wavgpv)
# Visualize
pvca_df_plot = ggplot(pvca_df) +
aes(x = batch, y = wavgpv) +
geom_col(fill = "#5e60ce") +
theme_minimal() +
theme(axis.text.x = element_text(size = 20, angle = 45, vjust = 1, hjust=1, color = "black"),
axis.text.y = element_text(size = 20, vjust = 1, hjust=1, color = "black")) +
geom_text(aes(label = round(wavgpv,3), y = wavgpv),
position = position_dodge(width = 0.9),
vjust = -0.2,
hjust = 0.5,
size = 4,
angle = 0)
pvca_df_plot
ggsave(pvca_df_plot, file = "pvca_raw_normalized_2.png", width = 12, height = 10)
pvca_df_plot
ggsave(pvca_df_plot, file = "pvca_raw_normalized_2.png", width = 12, height = 10)
getwd()
setwd("~/Desktop/Github - Covid Atlas")
ggsave(pvca_df_plot, file = "pvca_raw_normalized_2.png", width = 12, height = 10)
library(readr)
degs_all_updown_covid_other_immune_shared <- read_csv("VaxGO gene sets/degs_all_updown_covid_other_immune_shared.csv")
View(degs_all_updown_covid_other_immune_shared)
knitr::opts_chunk$set(echo = TRUE)
degs_all_updown_covid_other_immune_shared
ann_vaccines_covid_other
degs_all_updown_covid_other_immune_shared %>%
inner_join(ann_vaccines_covid_other, by = join_by(condition = Cond1))
degs_all_updown_covid_other_immune_shared %>%
inner_join(ann_vaccines_covid_other, by = join_by(condition == Cond1))
degs_all_updown_covid_other_immune_shared
degs_all_updown_covid_other_immune_shared %>%
inner_join(ann_vaccines_covid_other, by = join_by(Cond1 == condition))
degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other, by = join_by(Cond1 == condition))
degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID"), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(Cond2 == condition)) %>%
```
degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID"), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(Cond2 == condition))
degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID"), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(Cond2 == condition)) %>%
clean_names()
degs_all_updown_covid_other_immune_shared
degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID") %>% select(condition), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(Cond2 == condition)) %>%
clean_names() %>%
select(cond1, cond2, shared, genes_names, percentage_shared_cond1:qvalue, )
degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID") %>% select(condition), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(Cond2 == condition)) %>%
clean_names() %>%
select(cond1, cond2, shared, genes_names, percentage_shared_cond1:qvalue)
table = degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID") %>% select(condition), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(Cond2 == condition)) %>%
clean_names() %>%
select(cond1, cond2, shared, genes_names, percentage_shared_cond1:qvalue)
edges = degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID") %>% select(condition), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(Cond2 == condition)) %>%
clean_names() %>%
select(cond1, cond2, shared, genes_names, percentage_shared_cond1:qvalue)
nodes = ann_vaccines_covid_other
write_tsv(edges, file = "Network_Covid_Other_sharedgenes_edges.tsv")
write_tsv(nodes, file = "Network_Covid_Other_sharedgenes_nodes.tsv")
write.csv(edges, file = "Network_Covid_Other_sharedgenes_edges.csv", row.names = F)
my_colors
my_colors %>% select(condition, color)
my_colors %>% select(condition, color) %>%
write_tsv("covid_others_colors.tsv")
edges
degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID") %>% select(condition), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(Cond2 == condition)) %>%
clean_names()
edges = degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID"), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(Cond2 == condition)) %>%
clean_names() %>%
select(cond1, cond2, shared, genes_names, percentage_shared_cond1:qvalue)
edges
edges = degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID"), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(Cond2 == condition)) %>%
clean_names() %>%
select(cond1, cond2, shared, genes_names)
edges = degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID"), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(Cond2 == condition)) %>%
clean_names()
edges_mirror = edges %>% rename(Cond2.1 = Cond1, Cond1.2 = Cond2)
edges
edges_mirror = edges %>% rename(cond2.1 = cond1, cond1.2 = cond2)
edges %>% rename(cond2.1 = cond1, cond1.2 = cond2)
edges %>% rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2)
edges_mirror = edges %>% rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2)
edges_flourish = bind_rows(edges, edges_mirror)
write.csv(edges_flourish, file = "Network_Covid_Other_sharedgenes_edges.csv", row.names = F)
my_colors <- ann_vaccines_covid_other %>%
mutate(color = case_when(
type == "VLP" ~ "#D7B0EE",
type == "LA" ~ "#ffb703",
type == "CONJ" ~ "#015BA0",
type == "IN" ~ "#76c893",
type == "VV" ~ "#5e60ce",
type == "RNA" ~ "#56cfe1",
type == "SU" ~ "#b5e48c",
type == "I" ~ "#f72585",
TRUE ~ NA_character_))
my_colors %>% select(condition, color) %>%
write_tsv("covid_others_colors.tsv")
edges_mirror
edges_mirror = edges %>% rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1:qvalue)
edges_mirror
edges_mirror = edges %>% rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1:qvalue) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(cond1 == condition))
edges_mirror
edges_mirror = edges %>% rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1:qvalue) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(cond1 == condition))
edges_mirror
edges_mirror = edges %>% rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1:qvalue) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(cond1 == condition))
edges_flourish = bind_rows(edges, edges_mirror)
my_colors <- ann_vaccines_covid_other %>%
mutate(color = case_when(
type == "VLP" ~ "#D7B0EE",
type == "LA" ~ "#ffb703",
type == "CONJ" ~ "#015BA0",
type == "IN" ~ "#76c893",
type == "VV" ~ "#5e60ce",
type == "RNA" ~ "#56cfe1",
type == "SU" ~ "#b5e48c",
type == "I" ~ "#f72585",
TRUE ~ NA_character_),
color_covid_other = if_else(covid_other == "COVID", "#56cfe1", "#343a40"))
my_colors %>% select(condition, color) %>%
write_tsv("covid_others_colors.tsv")
my_colors %>% select(condition, color, color_covid_other) %>%
write_tsv("covid_others_colors.tsv")
edges_mirror
edges_mirror = edges %>% rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1:qvalue) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(cond1 == condition))
edges_flourish = bind_rows(edges, edges_mirror)
nodes = ann_vaccines_covid_other
my_colors <- ann_vaccines_covid_other %>%
mutate(color = case_when(
type == "VLP" ~ "#D7B0EE",
type == "LA" ~ "#ffb703",
type == "CONJ" ~ "#015BA0",
type == "IN" ~ "#76c893",
type == "VV" ~ "#5e60ce",
type == "RNA" ~ "#56cfe1",
type == "SU" ~ "#b5e48c",
type == "I" ~ "#f72585",
TRUE ~ NA_character_),
color_covid_other = if_else(covid_other == "COVID", "#56cfe1", "#343a40"))
my_colors %>% select(condition, color, color_covid_other) %>%
write_tsv("covid_others_colors.tsv")
write_tsv(edges_flourish, file = "Network_Covid_Other_sharedgenes_edges.tsv")
write.csv(edges_flourish, file = "Network_Covid_Other_sharedgenes_edges.csv", row.names = F)
edges_flourish
edges %>% rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2)
edges_mirror = edges %>% rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1, cond2, everything()) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(cond1 == condition))
edges_mirror
edges_mirror = edges %>% rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1, cond2, everything()) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(cond1 == condition))
edges_flourish = bind_rows(edges, edges_mirror)
nodes = ann_vaccines_covid_other
my_colors <- ann_vaccines_covid_other %>%
mutate(color = case_when(
type == "VLP" ~ "#D7B0EE",
type == "LA" ~ "#ffb703",
type == "CONJ" ~ "#015BA0",
type == "IN" ~ "#76c893",
type == "VV" ~ "#5e60ce",
type == "RNA" ~ "#56cfe1",
type == "SU" ~ "#b5e48c",
type == "I" ~ "#f72585",
TRUE ~ NA_character_),
color_covid_other = if_else(covid_other == "COVID", "#56cfe1", "#343a40"))
write_tsv(edges_flourish, file = "Network_Covid_Other_sharedgenes_edges.tsv")
write.csv(edges_flourish, file = "Network_Covid_Other_sharedgenes_edges.csv", row.names = F)
edges_flourish
edges_mirror
edges %>% rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1, cond2, everything())
edges %>%
rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2)
edges_mirror = edges %>%
select(cond1:qvalue) %>%
rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1, cond2, everything()) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(cond1 == condition))
edges_flourish = bind_rows(edges, edges_mirror)
nodes = ann_vaccines_covid_other
my_colors <- ann_vaccines_covid_other %>%
mutate(color = case_when(
type == "VLP" ~ "#D7B0EE",
type == "LA" ~ "#ffb703",
type == "CONJ" ~ "#015BA0",
type == "IN" ~ "#76c893",
type == "VV" ~ "#5e60ce",
type == "RNA" ~ "#56cfe1",
type == "SU" ~ "#b5e48c",
type == "I" ~ "#f72585",
TRUE ~ NA_character_),
color_covid_other = if_else(covid_other == "COVID", "#56cfe1", "#343a40"))
my_colors %>% select(condition, color, color_covid_other) %>%
write_tsv("covid_others_colors.tsv")
write_tsv(edges_flourish, file = "Network_Covid_Other_sharedgenes_edges.tsv")
write.csv(edges_flourish, file = "Network_Covid_Other_sharedgenes_edges.csv", row.names = F)
write_tsv(nodes, file = "Network_Covid_Other_sharedgenes_nodes.tsv")
ann_vaccines_covid_other
edges = degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID", !regimen %in% c("I", "I-I")), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(Cond2 == condition)) %>%
clean_names()
edges_mirror = edges %>%
select(cond1:qvalue) %>%
rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1, cond2, everything()) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(cond1 == condition))
edges_flourish = bind_rows(edges, edges_mirror)
nodes = ann_vaccines_covid_other
my_colors <- ann_vaccines_covid_other %>%
mutate(color = case_when(
type == "VLP" ~ "#D7B0EE",
type == "LA" ~ "#ffb703",
type == "CONJ" ~ "#015BA0",
type == "IN" ~ "#76c893",
type == "VV" ~ "#5e60ce",
type == "RNA" ~ "#56cfe1",
type == "SU" ~ "#b5e48c",
type == "I" ~ "#f72585",
TRUE ~ NA_character_),
color_covid_other = if_else(covid_other == "COVID", "#56cfe1", "#343a40"))
write_tsv(edges_flourish, file = "Network_Covid_Other_Vaccinesonly_sharedgenes_edges.tsv")
write.csv(edges_flourish, file = "Network_Covid_Other_Vaccinesonly_sharedgenes_edges.csv", row.names = F)
library(readr)
degs_all_updown_covid_other_nonimmune_shared <- read_csv("VaxGO gene sets/degs_all_updown_covid_other_nonimmune__shared.csv")
View(degs_all_updown_covid_other_nonimmune_shared)
filename = "degs_all_updown_covid_other_nonimmune_shared"
filename = "degs_all_updown_covid_other_nonimmune_shared"
edges = degs_all_updown_covid_other_nonimmune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID"), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(Cond2 == condition)) %>%
clean_names()
edges_mirror = edges %>%
select(cond1:qvalue) %>%
rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1, cond2, everything()) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(cond1 == condition))
edges_flourish = bind_rows(edges, edges_mirror)
nodes = ann_vaccines_covid_other
my_colors <- ann_vaccines_covid_other %>%
mutate(color = case_when(
type == "VLP" ~ "#D7B0EE",
type == "LA" ~ "#ffb703",
type == "CONJ" ~ "#015BA0",
type == "IN" ~ "#76c893",
type == "VV" ~ "#5e60ce",
type == "RNA" ~ "#56cfe1",
type == "SU" ~ "#b5e48c",
type == "I" ~ "#f72585",
TRUE ~ NA_character_),
color_covid_other = if_else(covid_other == "COVID", "#56cfe1", "#343a40"))
my_colors %>% select(condition, color, color_covid_other) %>%
write_tsv("covid_others_colors.tsv")
write_tsv(edges_flourish, file = paste0(filename, "Network_Covid_Other_sharedgenes_edges.tsv"))
write.csv(edges_flourish, file = paste0(filename, "Network_Covid_Other_sharedgenes_edges.csv"), row.names = F)
write_tsv(nodes, file = paste0(filename, "Network_Covid_Other_sharedgenes_nodes.tsv"))
edges = degs_all_updown_covid_other_nonimmune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID", !regimen %in% c("I", "I-I")), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(Cond2 == condition)) %>%
clean_names()
edges_mirror = edges %>%
select(cond1:qvalue) %>%
rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1, cond2, everything()) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(cond1 == condition))
edges_flourish = bind_rows(edges, edges_mirror)
nodes = ann_vaccines_covid_other
my_colors <- ann_vaccines_covid_other %>%
mutate(color = case_when(
type == "VLP" ~ "#D7B0EE",
type == "LA" ~ "#ffb703",
type == "CONJ" ~ "#015BA0",
type == "IN" ~ "#76c893",
type == "VV" ~ "#5e60ce",
type == "RNA" ~ "#56cfe1",
type == "SU" ~ "#b5e48c",
type == "I" ~ "#f72585",
TRUE ~ NA_character_),
color_covid_other = if_else(covid_other == "COVID", "#56cfe1", "#343a40"))
my_colors %>% select(condition, color, color_covid_other) %>%
write_tsv("covid_others_colors.tsv")
write_tsv(edges_flourish, file = paste0(filename, "Network_Covid_Other_Vaccinesonly_sharedgenes_edges.tsv"))
write.csv(edges_flourish, file = paste0(filename, "Network_Covid_Other_Vaccinesonly_sharedgenes_edges.csv"), row.names = F)
write_tsv(nodes, file = paste0(filename, "Network_Covid_Other_sharedgenes_nodes.tsv"))
nodes
edges_flourish
edges
edges_nodes = edges %>% inner_join(nodes, by = join_by(condition = cond1))
edges_nodes = edges %>% inner_join(nodes, by = join_by(condition =- cond1))
edges_nodes = edges %>% inner_join(nodes, by = join_by(condition == cond1))
edges_nodes = edges %>% inner_join(nodes, by = join_by(cond1 == condition))
edges_nodes
edges
edges_nodes = edges
write_tsv(edges_nodes, file = paste0(filename, "Network_Covid_Other_sharedgenes_edges_and_nodes.tsv"))
# Vaccines and infection -----
ann_vaccines_covid_other
degs_all_updown_covid_other_immune_shared
degs_all_updown_covid_other_nonimmune_shared
filename = "degs_all_updown_covid_other_immune_shared"
edges = degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID"), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(Cond2 == condition)) %>%
clean_names()
edges_mirror = edges %>%
select(cond1:qvalue) %>%
rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1, cond2, everything()) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(cond1 == condition))
edges_flourish = bind_rows(edges, edges_mirror)
nodes = ann_vaccines_covid_other
edges_nodes = edges
my_colors <- ann_vaccines_covid_other %>%
mutate(color = case_when(
type == "VLP" ~ "#D7B0EE",
type == "LA" ~ "#ffb703",
type == "CONJ" ~ "#015BA0",
type == "IN" ~ "#76c893",
type == "VV" ~ "#5e60ce",
type == "RNA" ~ "#56cfe1",
type == "SU" ~ "#b5e48c",
type == "I" ~ "#f72585",
TRUE ~ NA_character_),
color_covid_other = if_else(covid_other == "COVID", "#56cfe1", "#343a40"))
my_colors %>% select(condition, color, color_covid_other) %>%
write_tsv("covid_others_colors.tsv")
write_tsv(edges_nodes, file = paste0(filename, "Network_Covid_Other_sharedgenes_edges_and_nodes.tsv"))
write_tsv(edges_flourish, file = paste0(filename, "Network_Covid_Other_sharedgenes_edges.tsv"))
write.csv(edges_flourish, file = paste0(filename, "Network_Covid_Other_sharedgenes_edges.csv"), row.names = F)
write_tsv(nodes, file = paste0(filename, "Network_Covid_Other_sharedgenes_nodes.tsv"))
# Only Covid vaccination (previous or no previous infection) vs other vaccines-----
ann_vaccines_covid_other
edges = degs_all_updown_covid_other_immune_shared %>%
select(-"...1") %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "COVID", !regimen %in% c("I", "I-I")), by = join_by(Cond1 == condition)) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER") %>% select(condition), by = join_by(Cond2 == condition)) %>%
clean_names()
edges_mirror = edges %>%
select(cond1:qvalue) %>%
rename(cond2.1 = cond1, cond1.2 = cond2) %>%
rename(cond2 = cond2.1, cond1 = cond1.2) %>%
select(cond1, cond2, everything()) %>%
inner_join(ann_vaccines_covid_other %>% filter(covid_other == "OTHER"), by = join_by(cond1 == condition))
edges_flourish = bind_rows(edges, edges_mirror)
nodes = ann_vaccines_covid_other
my_colors <- ann_vaccines_covid_other %>%
mutate(color = case_when(
type == "VLP" ~ "#D7B0EE",
type == "LA" ~ "#ffb703",
type == "CONJ" ~ "#015BA0",
type == "IN" ~ "#76c893",
type == "VV" ~ "#5e60ce",
type == "RNA" ~ "#56cfe1",
type == "SU" ~ "#b5e48c",
type == "I" ~ "#f72585",
TRUE ~ NA_character_),
color_covid_other = if_else(covid_other == "COVID", "#56cfe1", "#343a40"))
my_colors %>% select(condition, color, color_covid_other) %>%
write_tsv("covid_others_colors.tsv")
write_tsv(edges_flourish, file = paste0(filename, "Network_Covid_Other_Vaccinesonly_sharedgenes_edges.tsv"))
write.csv(edges_flourish, file = paste0(filename, "Network_Covid_Other_Vaccinesonly_sharedgenes_edges.csv"), row.names = F)
write_tsv(nodes, file = paste0(filename, "Network_Covid_Other_sharedgenes_nodes.tsv"))
View(nesmat)
PC1
PC1_genes_counts
PC1_genes_counts = normalized_counts %>%
rownames_to_column("genes") %>%
inner_join(PC1, by = "genes") %>%
pivot_longer(cols = -c("genes", "Dim.1"), names_to = "sample", values_to = "counts") %>%
mutate(counts = round(counts, 0)) %>%
select(genes, sample, counts, Dim.1) %>%
inner_join(ann_vaccines_samples, by = "sample") %>%
filter(gse_id != "GSE206023") %>%
filter(genes == "CD3E") %>%
group_by(condition) %>%
filter(any(sex == 'Male') & any(sex == 'Female'),
condition != "H (D0)") %>%
ungroup() %>%
mutate(age_inter = cut(age, breaks = c(10, 20, 30, 40, 50, 60, 70, 80, 90, 100), labels = c("10-20", "21-30", "31-40", "41-50", "51-60", "61-70", "71-80", "81-90", "91-100")))
normalized_counts = all_matrices_normalized_counts
PC1_genes_counts = normalized_counts %>%
rownames_to_column("genes") %>%
inner_join(PC1, by = "genes") %>%
pivot_longer(cols = -c("genes", "Dim.1"), names_to = "sample", values_to = "counts") %>%
mutate(counts = round(counts, 0)) %>%
select(genes, sample, counts, Dim.1) %>%
inner_join(ann_vaccines_samples, by = "sample") %>%
filter(gse_id != "GSE206023") %>%
filter(genes == "CD3E") %>%
group_by(condition) %>%
filter(any(sex == 'Male') & any(sex == 'Female'),
condition != "H (D0)") %>%
ungroup() %>%
mutate(age_inter = cut(age, breaks = c(10, 20, 30, 40, 50, 60, 70, 80, 90, 100), labels = c("10-20", "21-30", "31-40", "41-50", "51-60", "61-70", "71-80", "81-90", "91-100")))
PC1_genes_counts
